<!DOCTYPE html>
<html lang="en">

    <head>
        <link rel="stylesheet" href="./mapUtility.css">
        <link rel="stylesheet" href="./universal.css">
        <div id="app-title">
            <img src="./content/mordhauforge_full.png" alt="MordhauForge" style="width:80%">
        </div>
        <button class="button" id="home">Home</button> <br/>
    </head>

    <body>
        

        <button class="collapsible">Settings</button>
        <div class="content">
            <div class="contentColl">
                <b id="destinationString"></b><br/>
                <input type="checkbox" name="vehicle1" value="Bike">test<br/>
                <input type="checkbox" name="vehicle1" value="Bike">test<br/>
            </div>
        </div>
        </br>
        <div id="mapcontent">

        </div>


    </body>
    <script>

        const electron = require("electron")
        const {dialog} = electron.remote;

        const {ipcRenderer} = electron;

        var mapData = {};
        var contentFolder = "\\Mordhau\\Content\\Mordhau";
        var mordhaudir = "C:\\Program Files (x86)\\Steam\\steamapps\\common\\Mordhau";
        var installSecondary = null;

        /// Utility Functions
        function refreshData() {
            ipcRenderer.send('open:import');
        }

        function updateDestination() {
            document.getElementById("destinationString").innerHTML = mordhaudir;
        }

        function updateRender() {
            var s = '';

            for( var i = 0; i < mapData.length; i++) {
                s = s + "</br><div class='mapTitle'><b>" + mapData[i]["_doc"].name + "</b></div>";
                s = s + "<div class='mapBanner'><img src='"+mapData[i]["_doc"].banner+"' class='mapBannerIMG'> </div>";
                s = s + "<div class='mapUtil'><button class='mapInstall' id='install" + i + "'>Install</button>"
                s = s + "<b>Version: " + mapData[i]["_doc"].version + " | Author: " + mapData[i]["_doc"].author + "</b> </div>";
            }

            return s;
        }

        document.getElementById("home").addEventListener("click", (e) => {
            ipcRenderer.send('open:home');
        });

        document.getElementById("home").addEventListener("change", (e) => {
            ipcRenderer.send('open:home');
        });


        /// IpcRenderers

        // Import
        ipcRenderer.on('open:import-reply', (event, arg) => {
            console.log(arg[1]);
            mapData = arg;

            document.getElementById("mapcontent").outerHTML = updateRender();
        })
        //


        /// Initialization
        refreshData();
        updateDestination();

        //////////////////
        ///  Collapse  ///
        //////////////////

        var coll = document.getElementsByClassName("collapsible");
        var i;

        for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                content.style.display = "none";
                } else {
                content.style.display = "block";
                }
            });
        }

    </script>

</html>